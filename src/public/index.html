{% extends 'base.html' %}

<title>BaeJino Design</title>

<style>
    div#root {
        align-items: flex-start;
    }

    ul {
        width: 550px;

        li {
            max-width: 100%;
            margin: 16px;
            padding: 16px 8px;
            list-style: none;

            div {
                display: flex;
                align-items: center;
                justify-content: space-between;

                span {
                    svg {
                        cursor: pointer;
                    }
                }
            }

            iframe {
                display: block;
                border: none;
                overflow: hidden;
                margin-top: 16px;
                width: 100%;
                height: 350px;
                background: #000;
                transition: all 5s ease;
            }

            iframe.lazy {
                backdrop-filter: blur(30px);
            }
        }
    }
</style>

<html>
    <div id="root" class="g-flex-center"></div>
</html>

<script>
    function lazyLoadResource() {
        if (!document.querySelectorAll) {
            Array.from(document.getElementsByClassName('lazy')).forEach((element: any) => {
                element.src = element.dataset.src;
            });
        }

        let lazyFrames = Array.from(document.querySelectorAll("iframe.lazy"));

        if ("IntersectionObserver" in window) {
            const lazyFrameObserver = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        let lazyFrame = entry.target;
                        lazyFrame.src = lazyFrame.dataset.src;
                        lazyFrame.classList.remove("lazy");
                        lazyFrameObserver.unobserve(lazyFrame);
                    }
                });
            });

            lazyFrames.forEach((lazyFrame) => {
                lazyFrameObserver.observe(lazyFrame);
            });
        } else {
            lazyFrames.forEach((entry) => {
                let lazyFrame = entry;
                lazyFrame.src = lazyFrame.dataset.src;
            });
        }
    }

    function capitalize(s) {
        if (typeof s !== 'string') return ''
        return s.charAt(0).toUpperCase() + s.slice(1)
    }

    const pages = {{ pages }};

    const ul = document.createElement('ul');
    pages.forEach((page, idx) => {
        const li = document.createElement('li');
        li.classList.add('g-card');

        const iframe = document.createElement('iframe');
        iframe.className = 'lazy';
        iframe.dataset.src = `/${page}/`;

        const div = document.createElement('div');

        const spanText = document.createElement('span');
        spanText.textContent = `${idx + 1}. ${page.split('-').map(capitalize).join(' ')}`;

        const spanIcon = document.createElement('span');
        spanIcon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ai ai-Enlarge"><path d="M14.5 9.5L21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></svg>`
        spanIcon.addEventListener('click', () => {
            location.href = page;
        })

        div.appendChild(spanText);
        div.appendChild(spanIcon);
        li.appendChild(div);
        li.appendChild(iframe);
        ul.appendChild(li);
    });

    document.getElementById('root').appendChild(ul);
    lazyLoadResource();
</script>